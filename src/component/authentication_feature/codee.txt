import React, { useEffect, useState } from 'react'
import axios from 'axios';
import '../css/HomePage.css'
import { useNavigate } from 'react-router-dom';

import Navbar from '../component/navbar/Navbar';
import Footer from '../component/footer/Footer';

interface JobPosting {
  JobID: number;
  EmployerID: number;
  Post_IMG: {
    type: string;
    data: number[];
  };
  Title: string;
  Description: string;
  Category: string | null;
  Location: string;
  Salary: number;
  PostDate: string;
}

function HomePage() {
  const navigate = useNavigate();
  const [jobPostings, setJobPostings] = useState<JobPosting[]>([]);

  //call data from API
  useEffect(() => {
    const fetchData = async () => {
      try {
        const response = await axios.get('http://localhost:3007/jobpostings');
        setJobPostings(response.data.data);
      } catch (error) {
        console.error('Error fetching job postings:', error);
      }
    };

    fetchData();
  }, []);

  return (
    <div>
      <Navbar />

      <center>
        <div className="contianer-home-page">
          <div className="box-haeder-home-page">
            <p className='text-in-box-haeder-home-page'>Welcome to us website</p>
          </div>
          <div className="box-for-text-recommend-job">
            recommend Job
          </div>

          <div className="box-item-for-recommend-job">
            {jobPostings.map((jobPosting) => (
              <div key={jobPosting.JobID} className="item-for-recommend-job">
                <div className='image-box-work-recommend-home-page'>
                  <img className='image-work-item-home-page'
                    src={`data:image/jpeg;base64,${btoa(jobPosting.Post_IMG.data.map((num) => String.fromCharCode(num)).join(''))}`}
                    alt={jobPosting.Title}
                  />
                  <img className='image-logo-item-home-page' src="Logo/job-logo-101.png" alt="" />
                </div>
                <div className='item-box-text-home-page'>
                  <p className='text-work-recommend-job-haeder'>{jobPosting.Title}</p>
                  <p className='text-work-recommend-job-detail'>Location: {jobPosting.Location}</p>
                  <p className='text-work-recommend-job-detail'>Salary: {jobPosting.Salary}</p>
                  <p className='text-work-recommend-job-date-posted'>Post Date: {jobPosting.PostDate}</p>
                  <hr className='hr-in-recommend-job-detail' />
                  <p className='btn-see-more-for-work-detail'>See more
                    <img className='icon-item-see-to-next-page-home-page' src="Icon/chevron-pointing-to-the-right.png" alt="Next" />
                  </p>
                </div>
              </div>
            ))}
          </div>

          <hr className='hr-bottom-recommend-job' />
          <p className='see-all-item-home-page' onClick={() => navigate('/Findjob')}>See ALL <img className='icon-see-all-to-next-page-home-page'
            src="Icon/chevron-pointing-to-the-right.png" alt="Next" /></p>

{/* find employee */}

          <div className="box-for-text-recommend-job">
            For Find Employee
          </div>
          <div className="box-item-for-recommend-job">
            <div className="item-for-recommend-job">
              <div className='image-box-work-recommend-home-page'>
                <img className='image-employee-item-home-page' src="Image/cv-example.jpg" alt="" />
                <img className='image-logo-item-home-page' src="Icon/profile-101.png" alt="" />
              </div>
              <div className='item-box-text-home-page'>
                <p className='text-work-recommend-job-haeder'>MR George</p>
                <p className='text-work-recommend-job-detail'><b>Position :</b> Project Manager <br />
                  <b>Education</b> : Hogwarts / Magic<br /></p>
                <p className='text-of-location-home-page'><img className='icon-location-home-page' src="Icon/location.png" alt="" /> Ban Donnoun, Vientiane, Laos<br /></p>
                <hr className='hr-in-recommend-job-detail' />
                <p className='btn-see-more-for-work-detail'>See more
                  <img className='icon-item-see-to-next-page-home-page' src="Icon/chevron-pointing-to-the-right.png" alt="Next" /></p>
              </div>
            </div>

            <div className="item-for-recommend-job">
              <div className='image-box-work-recommend-home-page'>
                <img className='image-employee-item-home-page' src="Image/cv-example.jpg" alt="" />
                <img className='image-logo-item-home-page' src="Icon/profile-101.png" alt="" />
              </div>
              <div className='item-box-text-home-page'>
                <p className='text-work-recommend-job-haeder'>MR George</p>
                <p className='text-work-recommend-job-detail'><b>Position :</b> Project Manager <br />
                  <b>Education</b> : Hogwarts / Magic<br /></p>
                <p className='text-of-location-home-page'><img className='icon-location-home-page' src="Icon/location.png" alt="" /> Ban Donnoun, Vientiane, Laos<br /></p>
                <hr className='hr-in-recommend-job-detail' />
                <p className='btn-see-more-for-work-detail'>See more
                  <img className='icon-item-see-to-next-page-home-page' src="Icon/chevron-pointing-to-the-right.png" alt="Next" /></p>
              </div>
            </div>

            <div className="item-for-recommend-job">
              <div className='image-box-work-recommend-home-page'>
                <img className='image-employee-item-home-page' src="Image/cv-example.jpg" alt="" />
                <img className='image-logo-item-home-page' src="Icon/profile-101.png" alt="" />
              </div>
              <div className='item-box-text-home-page'>
                <p className='text-work-recommend-job-haeder'>MR George</p>
                <p className='text-work-recommend-job-detail'><b>Position :</b> Project Manager <br />
                  <b>Education</b> : Hogwarts / Magic<br /></p>
                <p className='text-of-location-home-page'><img className='icon-location-home-page' src="Icon/location.png" alt="" /> Ban Donnoun, Vientiane, Laos<br /></p>
                <hr className='hr-in-recommend-job-detail' />
                <p className='btn-see-more-for-work-detail'>See more
                  <img className='icon-item-see-to-next-page-home-page' src="Icon/chevron-pointing-to-the-right.png" alt="Next" /></p>
              </div>
            </div>

            <div className="item-for-recommend-job">
              <div className='image-box-work-recommend-home-page'>
                <img className='image-employee-item-home-page' src="Image/cv-example.jpg" alt="" />
                <img className='image-logo-item-home-page' src="Icon/profile-101.png" alt="" />
              </div>
              <div className='item-box-text-home-page'>
                <p className='text-work-recommend-job-haeder'>MR George</p>
                <p className='text-work-recommend-job-detail'><b>Position :</b> Project Manager <br />
                  <b>Education</b> : Hogwarts / Magic<br /></p>
                <p className='text-of-location-home-page'><img className='icon-location-home-page' src="Icon/location.png" alt="" /> Ban Donnoun, Vientiane, Laos<br /></p>
                <hr className='hr-in-recommend-job-detail' />
                <p className='btn-see-more-for-work-detail'>See more
                  <img className='icon-item-see-to-next-page-home-page' src="Icon/chevron-pointing-to-the-right.png" alt="Next" /></p>
              </div>
            </div>

          </div>
          <hr className='hr-bottom-recommend-job' />
          <p className='see-all-item-home-page' onClick={() => navigate('/Findemployee')}>See ALL <img className='icon-see-all-to-next-page-home-page'
            src="Icon/chevron-pointing-to-the-right.png" alt="Next" /></p><br />

        </div>
      </center>
      <Footer />
    </div>
  )
}

export default HomePage
